length(taxa$Species)
mutspec <- mutspec %>% separate(gene_and_species, c("Gene", "Species"), sep="__")
mutspec = merge(mutspec, taxa, all.x = T)
no_class = mutspec[is.na(mutspec$Class) & mutspec$Mut == "A>G" & mutspec$Gene == "Cytb" & mutspec$Mut == "T>C",]
temptc = mutspec[mutspec$Mut == "T>C",]; temptc = temptc[c("Species", "MutSpec", "Gene", "Class")]; colnames(temptc) = c("Species", "A_G.heavy", "Gene", "Class")
tempag = mutspec[mutspec$Mut == "A>G",]; tempag = tempag[c("Species", "MutSpec", "Gene", "Class")]; colnames(tempag) = c("Species", "T_C.heavy", "Gene", "Class")
tempmutspectcag = merge(tempag, temptc)
table(is.na(tempmutspectcag$Class))
tempmutspectcag = tempmutspectcag[!is.na(tempmutspectcag$Class),]
#write.table(unique(tempmutspectcag$Species), file = "../data/2derived/species_for_tree.txt", row.names = F, col.names = F)
meanmutspec = tempmutspectcag %>% group_by(Species, Class); meanmutspec = meanmutspec %>% summarise(T_C.heavy=mean(T_C.heavy), A_G.heavy=mean(A_G.heavy))
meanmutspec = meanmutspec[meanmutspec$Class == "Mammalia",]
cytbmutspec = tempmutspectcag[tempmutspectcag$Gene == "Cytb",]
KT = read.table("../data/2derived/EcologyMammalianTable01_KuptsovA_ver2_Full.txt", sep='\t', header=TRUE)
alldata = merge(meanmutspec, KT, all = T)
#write.csv(alldata, file = "../data/2derived/EcologyMammalianTable01_KuptsovA_UPDATED.csv")
#alldata = merge(cytbmutspec, KT)
alldata$Temperature = as.numeric(gsub(",", ".", alldata$Temperature.C._White2003.2006.other.close.species))
alldata$GenerationLength_d = as.numeric(gsub(",", ".", alldata$GenerationLength_d))
alldata$AGdivTC.heavy = alldata$A_G.heavy / alldata$T_C.heavy
View(alldata)
tree = read.tree('../1raw/species_for_tree.nwk')
tree = read.tree('../data/1raw/species_for_tree.nwk')
row.names(alldata) = alldata$Species
View(alldata)
tree_pruned = treedata(tree, alldata, sort=T, warnings=T)$phy
data<-as.data.frame(treedata(tree_pruned, alldata, sort=T, warnings=T)$data)
data$Species = as.character(data$Species)
data$TCdivAG = as.numeric(as.character(data$TCdivAG))
data$AGdivTC.heavy = as.numeric(as.character(data$AGdivTC.heavy))
knitr::opts_chunk$set(echo = TRUE)
rm(list=ls(all=TRUE))
if (!require(caper)) install.packages("caper")
if (!require(geiger)) install.packages("geiger")
if (!require(ggpubr)) install.packages("ggpubr")
if (!require(dplyr)) install.packages("dplyr")
if (!require(tidyr)) install.packages("tidyr")
library(tidyr)
library(caper)
library(geiger)
library(ggpubr)
library(dplyr)
mutspec = read.csv('../data/2derived/internal_12_syn_mutspec_all.csv', row.names=1)
taxavictor = read.table('../data/1raw/Classes_from_Victor.txt', header = T)
taxa = read.table("../data/2derived/TaxaFromKostya.txt", header = T)
AA = read.table("../data/1raw/anage_data.txt", header = TRUE, sep = '\t')
AA$Species = paste(AA$Genus,AA$Species,sep = '_')
AAtaxa = AA[c("Species", "Class")]
taxa = rbind(taxa, AAtaxa)
taxa = rbind(taxa, taxavictor)
length(taxa$Species)
taxa = taxa[!duplicated(taxa$Species),]
length(taxa$Species)
mutspec <- mutspec %>% separate(gene_and_species, c("Gene", "Species"), sep="__")
mutspec = merge(mutspec, taxa, all.x = T)
no_class = mutspec[is.na(mutspec$Class) & mutspec$Mut == "A>G" & mutspec$Gene == "Cytb" & mutspec$Mut == "T>C",]
temptc = mutspec[mutspec$Mut == "T>C",]; temptc = temptc[c("Species", "MutSpec", "Gene", "Class")]; colnames(temptc) = c("Species", "A_G.heavy", "Gene", "Class")
tempag = mutspec[mutspec$Mut == "A>G",]; tempag = tempag[c("Species", "MutSpec", "Gene", "Class")]; colnames(tempag) = c("Species", "T_C.heavy", "Gene", "Class")
tempmutspectcag = merge(tempag, temptc)
table(is.na(tempmutspectcag$Class))
tempmutspectcag = tempmutspectcag[!is.na(tempmutspectcag$Class),]
#write.table(unique(tempmutspectcag$Species), file = "../data/2derived/species_for_tree.txt", row.names = F, col.names = F)
meanmutspec = tempmutspectcag %>% group_by(Species, Class); meanmutspec = meanmutspec %>% summarise(T_C.heavy=mean(T_C.heavy), A_G.heavy=mean(A_G.heavy))
meanmutspec = meanmutspec[meanmutspec$Class == "Mammalia",]
cytbmutspec = tempmutspectcag[tempmutspectcag$Gene == "Cytb",]
KT = read.table("../data/2derived/EcologyMammalianTable01_KuptsovA_ver2_Full.txt", sep='\t', header=TRUE)
alldata = merge(meanmutspec, KT, all = T)
#write.csv(alldata, file = "../data/2derived/EcologyMammalianTable01_KuptsovA_UPDATED.csv")
#alldata = merge(cytbmutspec, KT)
alldata$Temperature = as.numeric(gsub(",", ".", alldata$Temperature.C._White2003.2006.other.close.species))
alldata$GenerationLength_d = as.numeric(gsub(",", ".", alldata$GenerationLength_d))
alldata$AGdivTC.heavy = alldata$A_G.heavy / alldata$T_C.heavy
summary(lm(formula = A_G.heavy ~ Temperature + GenerationLength_d, data = alldata))
summary(lm(formula = A_G.heavy ~ scale(Temperature) + scale(GenerationLength_d), data = alldata))
summary(lm(formula = AGdivTC.heavy ~ Temperature + GenerationLength_d, data = alldata))
View(alldata)
alldata %>%  filter(AGdivTC.heavy==NaN)
alldata %>%  filter(AGdivTC.heavy=="NaN" | NA | Inf)
alldata %>%  filter(AGdivTC.heavy=="NaN"f)
alldata %>%  filter(AGdivTC.heavy=="NaN")
alldata %>%  filter(AGdivTC.heavy== 0)
alldata %>%  filter(A_G.heavy== 0 | T_C.heavy = 0)
alldata %>%  filter(A_G.heavy== 0 | T_C.heavy == 0)
str(alldata$T_C.heavy)
table(alldata$T_C.heavy)
alldata %>%  filter(A_G.heavy == 0 )
alldata %>%  filter(A_G.heavy == 0)
alldata %>%  filter(A_G.heavy == 0.00000000)
alldata = alldata %>%  filter(A_G.heavy == 0.00000000)
alldata = alldata %>%  filter(A_G.heavy != 0)
knitr::opts_chunk$set(echo = TRUE)
rm(list=ls(all=TRUE))
if (!require(caper)) install.packages("caper")
if (!require(geiger)) install.packages("geiger")
if (!require(ggpubr)) install.packages("ggpubr")
if (!require(dplyr)) install.packages("dplyr")
if (!require(tidyr)) install.packages("tidyr")
library(tidyr)
library(caper)
library(geiger)
library(ggpubr)
library(dplyr)
mutspec = read.csv('../data/2derived/internal_12_syn_mutspec_all.csv', row.names=1)
taxavictor = read.table('../data/1raw/Classes_from_Victor.txt', header = T)
taxa = read.table("../data/2derived/TaxaFromKostya.txt", header = T)
AA = read.table("../data/1raw/anage_data.txt", header = TRUE, sep = '\t')
AA$Species = paste(AA$Genus,AA$Species,sep = '_')
AAtaxa = AA[c("Species", "Class")]
taxa = rbind(taxa, AAtaxa)
taxa = rbind(taxa, taxavictor)
length(taxa$Species)
taxa = taxa[!duplicated(taxa$Species),]
length(taxa$Species)
mutspec <- mutspec %>% separate(gene_and_species, c("Gene", "Species"), sep="__")
mutspec = merge(mutspec, taxa, all.x = T)
no_class = mutspec[is.na(mutspec$Class) & mutspec$Mut == "A>G" & mutspec$Gene == "Cytb" & mutspec$Mut == "T>C",]
temptc = mutspec[mutspec$Mut == "T>C",]; temptc = temptc[c("Species", "MutSpec", "Gene", "Class")]; colnames(temptc) = c("Species", "A_G.heavy", "Gene", "Class")
tempag = mutspec[mutspec$Mut == "A>G",]; tempag = tempag[c("Species", "MutSpec", "Gene", "Class")]; colnames(tempag) = c("Species", "T_C.heavy", "Gene", "Class")
tempmutspectcag = merge(tempag, temptc)
table(is.na(tempmutspectcag$Class))
tempmutspectcag = tempmutspectcag[!is.na(tempmutspectcag$Class),]
#write.table(unique(tempmutspectcag$Species), file = "../data/2derived/species_for_tree.txt", row.names = F, col.names = F)
meanmutspec = tempmutspectcag %>% group_by(Species, Class); meanmutspec = meanmutspec %>% summarise(T_C.heavy=mean(T_C.heavy), A_G.heavy=mean(A_G.heavy))
meanmutspec = meanmutspec[meanmutspec$Class == "Mammalia",]
cytbmutspec = tempmutspectcag[tempmutspectcag$Gene == "Cytb",]
KT = read.table("../data/2derived/EcologyMammalianTable01_KuptsovA_ver2_Full.txt", sep='\t', header=TRUE)
alldata = merge(meanmutspec, KT, all = T)
#write.csv(alldata, file = "../data/2derived/EcologyMammalianTable01_KuptsovA_UPDATED.csv")
#alldata = merge(cytbmutspec, KT)
alldata$Temperature = as.numeric(gsub(",", ".", alldata$Temperature.C._White2003.2006.other.close.species))
alldata$GenerationLength_d = as.numeric(gsub(",", ".", alldata$GenerationLength_d))
table(alldata$T_C.heavy)
alldata = alldata %>%  filter(A_G.heavy != 0)
View(alldata)
alldata = alldata %>%  filter(A_G.heavy != 0 | T_C.heavy != 0 )
alldata = alldata %>%  filter(A_G.heavy != 0 & T_C.heavy != 0 )
alldata$AGdivTC.heavy = alldata$A_G.heavy / alldata$T_C.heavy
knitr::opts_chunk$set(echo = TRUE)
rm(list=ls(all=TRUE))
if (!require(caper)) install.packages("caper")
if (!require(geiger)) install.packages("geiger")
if (!require(ggpubr)) install.packages("ggpubr")
if (!require(dplyr)) install.packages("dplyr")
if (!require(tidyr)) install.packages("tidyr")
library(tidyr)
library(caper)
library(geiger)
library(ggpubr)
library(dplyr)
mutspec = read.csv('../data/2derived/internal_12_syn_mutspec_all.csv', row.names=1)
taxavictor = read.table('../data/1raw/Classes_from_Victor.txt', header = T)
taxa = read.table("../data/2derived/TaxaFromKostya.txt", header = T)
AA = read.table("../data/1raw/anage_data.txt", header = TRUE, sep = '\t')
AA$Species = paste(AA$Genus,AA$Species,sep = '_')
AAtaxa = AA[c("Species", "Class")]
taxa = rbind(taxa, AAtaxa)
taxa = rbind(taxa, taxavictor)
length(taxa$Species)
taxa = taxa[!duplicated(taxa$Species),]
length(taxa$Species)
mutspec <- mutspec %>% separate(gene_and_species, c("Gene", "Species"), sep="__")
mutspec = merge(mutspec, taxa, all.x = T)
no_class = mutspec[is.na(mutspec$Class) & mutspec$Mut == "A>G" & mutspec$Gene == "Cytb" & mutspec$Mut == "T>C",]
temptc = mutspec[mutspec$Mut == "T>C",]; temptc = temptc[c("Species", "MutSpec", "Gene", "Class")]; colnames(temptc) = c("Species", "A_G.heavy", "Gene", "Class")
tempag = mutspec[mutspec$Mut == "A>G",]; tempag = tempag[c("Species", "MutSpec", "Gene", "Class")]; colnames(tempag) = c("Species", "T_C.heavy", "Gene", "Class")
tempmutspectcag = merge(tempag, temptc)
table(is.na(tempmutspectcag$Class))
tempmutspectcag = tempmutspectcag[!is.na(tempmutspectcag$Class),]
#write.table(unique(tempmutspectcag$Species), file = "../data/2derived/species_for_tree.txt", row.names = F, col.names = F)
meanmutspec = tempmutspectcag %>% group_by(Species, Class); meanmutspec = meanmutspec %>% summarise(T_C.heavy=mean(T_C.heavy), A_G.heavy=mean(A_G.heavy))
meanmutspec = meanmutspec[meanmutspec$Class == "Mammalia",]
cytbmutspec = tempmutspectcag[tempmutspectcag$Gene == "Cytb",]
KT = read.table("../data/2derived/EcologyMammalianTable01_KuptsovA_ver2_Full.txt", sep='\t', header=TRUE)
alldata = merge(meanmutspec, KT, all = T)
#write.csv(alldata, file = "../data/2derived/EcologyMammalianTable01_KuptsovA_UPDATED.csv")
#alldata = merge(cytbmutspec, KT)
alldata$Temperature = as.numeric(gsub(",", ".", alldata$Temperature.C._White2003.2006.other.close.species))
alldata$GenerationLength_d = as.numeric(gsub(",", ".", alldata$GenerationLength_d))
table(alldata$T_C.heavy)
alldata = alldata %>%  filter(A_G.heavy != 0 & T_C.heavy != 0 )
alldata$AGdivTC.heavy = alldata$A_G.heavy / alldata$T_C.heavy
View(alldata)
knitr::opts_chunk$set(echo = TRUE)
rm(list=ls(all=TRUE))
if (!require(caper)) install.packages("caper")
if (!require(geiger)) install.packages("geiger")
if (!require(ggpubr)) install.packages("ggpubr")
if (!require(dplyr)) install.packages("dplyr")
if (!require(tidyr)) install.packages("tidyr")
library(tidyr)
library(caper)
library(geiger)
library(ggpubr)
library(dplyr)
mutspec = read.csv('../data/2derived/internal_12_syn_mutspec_all.csv', row.names=1)
taxavictor = read.table('../data/1raw/Classes_from_Victor.txt', header = T)
taxa = read.table("../data/2derived/TaxaFromKostya.txt", header = T)
AA = read.table("../data/1raw/anage_data.txt", header = TRUE, sep = '\t')
AA$Species = paste(AA$Genus,AA$Species,sep = '_')
AAtaxa = AA[c("Species", "Class")]
taxa = rbind(taxa, AAtaxa)
taxa = rbind(taxa, taxavictor)
length(taxa$Species)
taxa = taxa[!duplicated(taxa$Species),]
length(taxa$Species)
mutspec <- mutspec %>% separate(gene_and_species, c("Gene", "Species"), sep="__")
mutspec = merge(mutspec, taxa, all.x = T)
no_class = mutspec[is.na(mutspec$Class) & mutspec$Mut == "A>G" & mutspec$Gene == "Cytb" & mutspec$Mut == "T>C",]
temptc = mutspec[mutspec$Mut == "T>C",]; temptc = temptc[c("Species", "MutSpec", "Gene", "Class")]; colnames(temptc) = c("Species", "A_G.heavy", "Gene", "Class")
tempag = mutspec[mutspec$Mut == "A>G",]; tempag = tempag[c("Species", "MutSpec", "Gene", "Class")]; colnames(tempag) = c("Species", "T_C.heavy", "Gene", "Class")
tempmutspectcag = merge(tempag, temptc)
table(is.na(tempmutspectcag$Class))
tempmutspectcag = tempmutspectcag[!is.na(tempmutspectcag$Class),]
#write.table(unique(tempmutspectcag$Species), file = "../data/2derived/species_for_tree.txt", row.names = F, col.names = F)
meanmutspec = tempmutspectcag %>% group_by(Species, Class); meanmutspec = meanmutspec %>% summarise(T_C.heavy=mean(T_C.heavy), A_G.heavy=mean(A_G.heavy))
meanmutspec = meanmutspec[meanmutspec$Class == "Mammalia",]
cytbmutspec = tempmutspectcag[tempmutspectcag$Gene == "Cytb",]
KT = read.table("../data/2derived/EcologyMammalianTable01_KuptsovA_ver2_Full.txt", sep='\t', header=TRUE)
alldata = merge(meanmutspec, KT, all = T)
#write.csv(alldata, file = "../data/2derived/EcologyMammalianTable01_KuptsovA_UPDATED.csv")
#alldata = merge(cytbmutspec, KT)
alldata$Temperature = as.numeric(gsub(",", ".", alldata$Temperature.C._White2003.2006.other.close.species))
alldata$GenerationLength_d = as.numeric(gsub(",", ".", alldata$GenerationLength_d))
alldata = alldata %>%  filter(A_G.heavy != 0 & T_C.heavy != 0 )
alldata$AGdivTC.heavy = alldata$A_G.heavy / alldata$T_C.heavy
summary(lm(formula = A_G.heavy ~ Temperature + GenerationLength_d, data = alldata))
summary(lm(formula = A_G.heavy ~ scale(Temperature) + scale(GenerationLength_d), data = alldata))
summary(lm(formula = AGdivTC.heavy ~ Temperature + GenerationLength_d, data = alldata))
summary(lm(formula = AGdivTC.heavy ~ scale(Temperature) + scale(GenerationLength_d), data = alldata))
alldata$MarsMono = alldata$Mars + alldata$Mono; table(alldata$MarsMono)
alldata$ColdSpecies = 0
alldata[alldata$Species %in% alldata[alldata$Temperature <= mean(alldata[!is.na(alldata$Temperature),]$Temperature) & !is.na(alldata$Temperature),]$Species,]$ColdSpecies = 1; table(alldata$ColdSpecies)
alldata$AllColdSpecies = alldata$Hib.unconfirmedHib + alldata$Daily.unconfirmedDaily + alldata$MarsMono + alldata$ColdSpecies
alldata[alldata$AllColdSpecies > 0,]$AllColdSpecies = 1; table(alldata$AllColdSpecies)
alldata$MarsMono = alldata$Mars + alldata$Mono; table(alldata$MarsMono)
alldata$ColdSpecies = 0
alldata[alldata$Species %in% alldata[alldata$Temperature <= mean(alldata[!is.na(alldata$Temperature),]$Temperature) & !is.na(alldata$Temperature),]$Species,]$ColdSpecies = 1; table(alldata$ColdSpecies)
alldata$AllColdSpecies = alldata$Hib.unconfirmedHib + alldata$Daily.unconfirmedDaily + alldata$MarsMono + alldata$ColdSpecies
alldata[alldata$AllColdSpecies > 0,]$AllColdSpecies = 1; table(alldata$AllColdSpecies)
knitr::opts_chunk$set(echo = TRUE)
rm(list=ls(all=TRUE))
if (!require(caper)) install.packages("caper")
if (!require(geiger)) install.packages("geiger")
if (!require(ggpubr)) install.packages("ggpubr")
if (!require(dplyr)) install.packages("dplyr")
if (!require(tidyr)) install.packages("tidyr")
library(tidyr)
library(caper)
library(geiger)
library(ggpubr)
library(dplyr)
mutspec = read.csv('../data/2derived/internal_12_syn_mutspec_all.csv', row.names=1)
taxavictor = read.table('../data/1raw/Classes_from_Victor.txt', header = T)
taxa = read.table("../data/2derived/TaxaFromKostya.txt", header = T)
AA = read.table("../data/1raw/anage_data.txt", header = TRUE, sep = '\t')
AA$Species = paste(AA$Genus,AA$Species,sep = '_')
AAtaxa = AA[c("Species", "Class")]
taxa = rbind(taxa, AAtaxa)
taxa = rbind(taxa, taxavictor)
length(taxa$Species)
taxa = taxa[!duplicated(taxa$Species),]
length(taxa$Species)
mutspec <- mutspec %>% separate(gene_and_species, c("Gene", "Species"), sep="__")
mutspec = merge(mutspec, taxa, all.x = T)
no_class = mutspec[is.na(mutspec$Class) & mutspec$Mut == "A>G" & mutspec$Gene == "Cytb" & mutspec$Mut == "T>C",]
temptc = mutspec[mutspec$Mut == "T>C",]; temptc = temptc[c("Species", "MutSpec", "Gene", "Class")]; colnames(temptc) = c("Species", "A_G.heavy", "Gene", "Class")
tempag = mutspec[mutspec$Mut == "A>G",]; tempag = tempag[c("Species", "MutSpec", "Gene", "Class")]; colnames(tempag) = c("Species", "T_C.heavy", "Gene", "Class")
tempmutspectcag = merge(tempag, temptc)
table(is.na(tempmutspectcag$Class))
tempmutspectcag = tempmutspectcag[!is.na(tempmutspectcag$Class),]
#write.table(unique(tempmutspectcag$Species), file = "../data/2derived/species_for_tree.txt", row.names = F, col.names = F)
meanmutspec = tempmutspectcag %>% group_by(Species, Class); meanmutspec = meanmutspec %>% summarise(T_C.heavy=mean(T_C.heavy), A_G.heavy=mean(A_G.heavy))
meanmutspec = meanmutspec[meanmutspec$Class == "Mammalia",]
cytbmutspec = tempmutspectcag[tempmutspectcag$Gene == "Cytb",]
KT = read.table("../data/2derived/EcologyMammalianTable01_KuptsovA_ver2_Full.txt", sep='\t', header=TRUE)
alldata = merge(meanmutspec, KT, all = T)
#write.csv(alldata, file = "../data/2derived/EcologyMammalianTable01_KuptsovA_UPDATED.csv")
#alldata = merge(cytbmutspec, KT)
alldata$Temperature = as.numeric(gsub(",", ".", alldata$Temperature.C._White2003.2006.other.close.species))
alldata$GenerationLength_d = as.numeric(gsub(",", ".", alldata$GenerationLength_d))
alldata = alldata %>%  filter(A_G.heavy != 0 & T_C.heavy != 0 )
alldata$AGdivTC.heavy = alldata$A_G.heavy / alldata$T_C.heavy
summary(lm(formula = A_G.heavy ~ Temperature + GenerationLength_d, data = alldata))
summary(lm(formula = A_G.heavy ~ scale(Temperature) + scale(GenerationLength_d), data = alldata))
summary(lm(formula = AGdivTC.heavy ~ Temperature + GenerationLength_d, data = alldata))
summary(lm(formula = AGdivTC.heavy ~ scale(Temperature) + scale(GenerationLength_d), data = alldata))
alldata$MarsMono = alldata$Mars + alldata$Mono; table(alldata$MarsMono)
alldata$ColdSpecies = 0
alldata[alldata$Species %in% alldata[alldata$Temperature <= mean(alldata[!is.na(alldata$Temperature),]$Temperature) & !is.na(alldata$Temperature),]$Species,]$ColdSpecies = 1; table(alldata$ColdSpecies)
alldata$AllColdSpecies = alldata$Hib.unconfirmedHib + alldata$Daily.unconfirmedDaily + alldata$MarsMono + alldata$ColdSpecies
View(alldata)
knitr::opts_chunk$set(echo = TRUE)
rm(list=ls(all=TRUE))
if (!require(caper)) install.packages("caper")
if (!require(geiger)) install.packages("geiger")
if (!require(ggpubr)) install.packages("ggpubr")
if (!require(dplyr)) install.packages("dplyr")
if (!require(tidyr)) install.packages("tidyr")
library(tidyr)
library(caper)
library(geiger)
library(ggpubr)
library(dplyr)
mutspec = read.csv('../data/2derived/internal_12_syn_mutspec_all.csv', row.names=1)
taxavictor = read.table('../data/1raw/Classes_from_Victor.txt', header = T)
taxa = read.table("../data/2derived/TaxaFromKostya.txt", header = T)
AA = read.table("../data/1raw/anage_data.txt", header = TRUE, sep = '\t')
AA$Species = paste(AA$Genus,AA$Species,sep = '_')
AAtaxa = AA[c("Species", "Class")]
taxa = rbind(taxa, AAtaxa)
taxa = rbind(taxa, taxavictor)
length(taxa$Species)
taxa = taxa[!duplicated(taxa$Species),]
length(taxa$Species)
mutspec <- mutspec %>% separate(gene_and_species, c("Gene", "Species"), sep="__")
mutspec = merge(mutspec, taxa, all.x = T)
no_class = mutspec[is.na(mutspec$Class) & mutspec$Mut == "A>G" & mutspec$Gene == "Cytb" & mutspec$Mut == "T>C",]
temptc = mutspec[mutspec$Mut == "T>C",]; temptc = temptc[c("Species", "MutSpec", "Gene", "Class")]; colnames(temptc) = c("Species", "A_G.heavy", "Gene", "Class")
tempag = mutspec[mutspec$Mut == "A>G",]; tempag = tempag[c("Species", "MutSpec", "Gene", "Class")]; colnames(tempag) = c("Species", "T_C.heavy", "Gene", "Class")
tempmutspectcag = merge(tempag, temptc)
table(is.na(tempmutspectcag$Class))
tempmutspectcag = tempmutspectcag[!is.na(tempmutspectcag$Class),]
#write.table(unique(tempmutspectcag$Species), file = "../data/2derived/species_for_tree.txt", row.names = F, col.names = F)
meanmutspec = tempmutspectcag %>% group_by(Species, Class); meanmutspec = meanmutspec %>% summarise(T_C.heavy=mean(T_C.heavy), A_G.heavy=mean(A_G.heavy))
meanmutspec = meanmutspec[meanmutspec$Class == "Mammalia",]
cytbmutspec = tempmutspectcag[tempmutspectcag$Gene == "Cytb",]
KT = read.table("../data/2derived/EcologyMammalianTable01_KuptsovA_ver2_Full.txt", sep='\t', header=TRUE)
alldata = merge(meanmutspec, KT, all = T)
#write.csv(alldata, file = "../data/2derived/EcologyMammalianTable01_KuptsovA_UPDATED.csv")
#alldata = merge(cytbmutspec, KT)
alldata$Temperature = as.numeric(gsub(",", ".", alldata$Temperature.C._White2003.2006.other.close.species))
alldata$GenerationLength_d = as.numeric(gsub(",", ".", alldata$GenerationLength_d))
alldata = alldata %>%  filter(A_G.heavy != 0 & T_C.heavy != 0 )
alldata$AGdivTC.heavy = alldata$A_G.heavy / alldata$T_C.heavy
summary(lm(formula = A_G.heavy ~ Temperature + GenerationLength_d, data = alldata))
summary(lm(formula = A_G.heavy ~ scale(Temperature) + scale(GenerationLength_d), data = alldata))
summary(lm(formula = AGdivTC.heavy ~ Temperature + GenerationLength_d, data = alldata))
summary(lm(formula = AGdivTC.heavy ~ scale(Temperature) + scale(GenerationLength_d), data = alldata))
alldata$MarsMono = alldata$Mars + alldata$Mono; table(alldata$MarsMono)
View(alldata)
alldata$ColdSpecies = 0
alldata[alldata$Species %in% alldata[alldata$Temperature <= mean(alldata[!is.na(alldata$Temperature),]$Temperature) & !is.na(alldata$Temperature),]$Species,]$ColdSpecies = 1; table(alldata$ColdSpecies)
alldata$AllColdSpecies = alldata$Hib.unconfirmedHib + alldata$Daily.unconfirmedDaily + alldata$MarsMono + alldata$ColdSpecies
alldata = alldata %>%  filter(!is.na(AllColdSpecies))
alldata[alldata$AllColdSpecies > 0,]$AllColdSpecies = 1; table(alldata$AllColdSpecies)
summary(lm(formula = AGdivTC.heavy ~ AllColdSpecies + GenerationLength_d, data = alldata))
summary(lm(formula = AGdivTC.heavy ~ scale(GenerationLength_d), data = alldata))
View(alldata)
tree = read.tree('../data/1raw/species_for_tree.nwk')
row.names(alldata) = alldata$Species
tree_pruned = treedata(tree, alldata, sort=T, warnings=T)$phy
data<-as.data.frame(treedata(tree_pruned, alldata, sort=T, warnings=T)$data)
data$Species = as.character(data$Species)
data$AGdivTC.heavy = as.numeric(as.character(data$AGdivTC.heavy))
data$Temperature = as.numeric(as.character(data$Temperature))
data$GenerationLength_d = as.numeric(as.character(data$GenerationLength_d))
data$AllColdSpecies = as.numeric(as.character(data$AllColdSpecies))
data_comp <- comparative.data(tree_pruned, data[, c('Species', 'AGdivTC.heavy',
'GenerationLength_d', 'Temperature', 'AllColdSpecies')], Species, vcv=TRUE)
summary(pgls(AGdivTC.heavy ~ scale(Temperature) + scale(GenerationLength_d), data_comp, lambda="ML"))
summary(pgls(TCdivAG ~ AllColdSpecies + scale(GenerationLength_d), data_comp, lambda="ML"))
summary(pgls(AGdivTC.heavy ~ AllColdSpecies + scale(GenerationLength_d), data_comp, lambda="ML"))
summary(pgls(AGdivTC.heavy ~ scale(GenerationLength_d), data_comp, lambda="ML"))
knitr::opts_chunk$set(echo = TRUE)
rm(list=ls(all=TRUE))
if (!require(caper)) install.packages("caper")
if (!require(geiger)) install.packages("geiger")
if (!require(ggpubr)) install.packages("ggpubr")
if (!require(dplyr)) install.packages("dplyr")
if (!require(tidyr)) install.packages("tidyr")
library(tidyr)
library(caper)
library(geiger)
library(ggpubr)
library(dplyr)
sinnuccontent = read.table("../data/2derived/AllGenesCodonUsageNoOverlap.txt", header = TRUE, sep = '\t')
sinnuccontent = sinnuccontent[sinnuccontent$Gene != 'ND6',]
sinnuccontent = aggregate(list(sinnuccontent$NeutralA,sinnuccontent$NeutralT,sinnuccontent$NeutralG,sinnuccontent$NeutralC), by = list(sinnuccontent$Species), FUN = sum)
names(sinnuccontent) = c('Species','NeutralA','NeutralT','NeutralG','NeutralC')
sinnuccontent$FrT.heavy = sinnuccontent$NeutralA / (sinnuccontent$NeutralA + sinnuccontent$NeutralT + sinnuccontent$NeutralG + sinnuccontent$NeutralC)
sinnuccontent$FrA.heavy = sinnuccontent$NeutralT / (sinnuccontent$NeutralA + sinnuccontent$NeutralT + sinnuccontent$NeutralG + sinnuccontent$NeutralC)
sinnuccontent$FrC.heavy = sinnuccontent$NeutralG / (sinnuccontent$NeutralA + sinnuccontent$NeutralT + sinnuccontent$NeutralG + sinnuccontent$NeutralC)
sinnuccontent$FrG.heavy = sinnuccontent$NeutralC / (sinnuccontent$NeutralA + sinnuccontent$NeutralT + sinnuccontent$NeutralG + sinnuccontent$NeutralC)
KT = read.table("../data/2derived/EcologyMammalianTable01_KuptsovA_ver2_Full.txt", sep='\t', header=TRUE)
KT$FrT= NULL
alldata = merge(sinnuccontent, KT)
alldata$Temperature = as.numeric(gsub(",", ".", alldata$Temperature.C._White2003.2006.other.close.species))
alldata$GenerationLength_d = as.numeric(gsub(",", ".", alldata$GenerationLength_d))
alldata$AC.heavy = alldata$FrA.heavy+alldata$FrC.heavy
alldata$TG.heavy = alldata$FrT.heavy+alldata$FrG.heavy
alldata$TG_ACSkew = (alldata$TG.heavy-alldata$AC.heavy)/(alldata$AC.heavy+alldata$TG.heavy)
summary(lm(formula = FrA.heavy ~ scale(GenerationLength_d)+scale(Temperature), data = alldata))
summary(lm(TG_ACSkew ~ log2(Temperature)+log2(GenerationLength_d), data = alldata))
summary(lm(TG_ACSkew ~ scale(Temperature)+scale(GenerationLength_d), data = alldata))
alldata$MarsMono = alldata$Mars + alldata$Mono; table(alldata$MarsMono)
alldata$ColdSpecies = 0
alldata[alldata$Species %in% alldata[alldata$Temperature <= mean(alldata[!is.na(alldata$Temperature),]$Temperature) & !is.na(alldata$Temperature),]$Species,]$ColdSpecies = 1; table(alldata$ColdSpecies)
alldata$AllColdSpecies = alldata$Hib.unconfirmedHib + alldata$Daily.unconfirmedDaily + alldata$MarsMono + alldata$ColdSpecies
alldata[alldata$AllColdSpecies > 0,]$AllColdSpecies = 1; table(alldata$AllColdSpecies)
summary(lm(formula = TG_ACSkew ~ log2(GenerationLength_d)+AllColdSpecies, data = alldata))
summary(lm(formula = FrA.heavy ~ log2(GenerationLength_d)+AllColdSpecies, data = alldata))
knitr::opts_chunk$set(echo = TRUE)
rm(list=ls(all=TRUE))
if (!require(caper)) install.packages("caper")
if (!require(geiger)) install.packages("geiger")
if (!require(ggpubr)) install.packages("ggpubr")
if (!require(dplyr)) install.packages("dplyr")
if (!require(tidyr)) install.packages("tidyr")
library(tidyr)
library(caper)
library(geiger)
library(ggpubr)
library(dplyr)
sinnuccontent = read.table("../data/2derived/AllGenesCodonUsageNoOverlap.txt", header = TRUE, sep = '\t')
sinnuccontent = sinnuccontent[sinnuccontent$Gene != 'ND6',]
sinnuccontent = aggregate(list(sinnuccontent$NeutralA,sinnuccontent$NeutralT,sinnuccontent$NeutralG,sinnuccontent$NeutralC), by = list(sinnuccontent$Species), FUN = sum)
names(sinnuccontent) = c('Species','NeutralA','NeutralT','NeutralG','NeutralC')
sinnuccontent$FrT.heavy = sinnuccontent$NeutralA / (sinnuccontent$NeutralA + sinnuccontent$NeutralT + sinnuccontent$NeutralG + sinnuccontent$NeutralC)
sinnuccontent$FrA.heavy = sinnuccontent$NeutralT / (sinnuccontent$NeutralA + sinnuccontent$NeutralT + sinnuccontent$NeutralG + sinnuccontent$NeutralC)
sinnuccontent$FrC.heavy = sinnuccontent$NeutralG / (sinnuccontent$NeutralA + sinnuccontent$NeutralT + sinnuccontent$NeutralG + sinnuccontent$NeutralC)
sinnuccontent$FrG.heavy = sinnuccontent$NeutralC / (sinnuccontent$NeutralA + sinnuccontent$NeutralT + sinnuccontent$NeutralG + sinnuccontent$NeutralC)
knitr::opts_chunk$set(echo = TRUE)
rm(list=ls(all=TRUE))
if (!require(caper)) install.packages("caper")
if (!require(geiger)) install.packages("geiger")
if (!require(ggpubr)) install.packages("ggpubr")
if (!require(dplyr)) install.packages("dplyr")
if (!require(tidyr)) install.packages("tidyr")
library(tidyr)
library(caper)
library(geiger)
library(ggpubr)
library(dplyr)
sinnuccontent = read.table("../data/2derived/AllGenesCodonUsageNoOverlap.txt", header = TRUE, sep = '\t')
sinnuccontent = sinnuccontent[sinnuccontent$Gene != 'ND6',]
sinnuccontent = aggregate(list(sinnuccontent$NeutralA,sinnuccontent$NeutralT,sinnuccontent$NeutralG,sinnuccontent$NeutralC), by = list(sinnuccontent$Species), FUN = sum)
names(sinnuccontent) = c('Species','NeutralA','NeutralT','NeutralG','NeutralC')
sinnuccontent$FrT.heavy = sinnuccontent$NeutralA / (sinnuccontent$NeutralA + sinnuccontent$NeutralT + sinnuccontent$NeutralG + sinnuccontent$NeutralC)
sinnuccontent$FrA.heavy = sinnuccontent$NeutralT / (sinnuccontent$NeutralA + sinnuccontent$NeutralT + sinnuccontent$NeutralG + sinnuccontent$NeutralC)
sinnuccontent$FrC.heavy = sinnuccontent$NeutralG / (sinnuccontent$NeutralA + sinnuccontent$NeutralT + sinnuccontent$NeutralG + sinnuccontent$NeutralC)
sinnuccontent$FrG.heavy = sinnuccontent$NeutralC / (sinnuccontent$NeutralA + sinnuccontent$NeutralT + sinnuccontent$NeutralG + sinnuccontent$NeutralC)
KT = read.table("../data/2derived/EcologyMammalianTable01_KuptsovA_ver2_Full.txt", sep='\t', header=TRUE)
KT$FrT= NULL
alldata = merge(sinnuccontent, KT)
alldata$Temperature = as.numeric(gsub(",", ".", alldata$Temperature.C._White2003.2006.other.close.species))
alldata$GenerationLength_d = as.numeric(gsub(",", ".", alldata$GenerationLength_d))
alldata$AC.heavy = alldata$FrA.heavy+alldata$FrC.heavy
alldata$TG.heavy = alldata$FrT.heavy+alldata$FrG.heavy
alldata$TG_ACSkew = (alldata$TG.heavy-alldata$AC.heavy)/(alldata$AC.heavy+alldata$TG.heavy)
summary(lm(formula = FrA.heavy ~ scale(GenerationLength_d)+scale(Temperature), data = alldata))
summary(lm(TG_ACSkew ~ log2(Temperature)+log2(GenerationLength_d), data = alldata))
summary(lm(TG_ACSkew ~ scale(Temperature)+scale(GenerationLength_d), data = alldata))
alldata$MarsMono = alldata$Mars + alldata$Mono; table(alldata$MarsMono)
alldata$ColdSpecies = 0
alldata[alldata$Species %in% alldata[alldata$Temperature <= mean(alldata[!is.na(alldata$Temperature),]$Temperature) & !is.na(alldata$Temperature),]$Species,]$ColdSpecies = 1; table(alldata$ColdSpecies)
alldata$AllColdSpecies = alldata$Hib.unconfirmedHib + alldata$Daily.unconfirmedDaily + alldata$MarsMono + alldata$ColdSpecies
alldata[alldata$AllColdSpecies > 0,]$AllColdSpecies = 1; table(alldata$AllColdSpecies)
summary(lm(formula = TG_ACSkew ~ log2(GenerationLength_d)+AllColdSpecies, data = alldata))
summary(lm(formula = FrA.heavy ~ log2(GenerationLength_d)+AllColdSpecies, data = alldata))
tree = read.tree('../data/1raw/species_for_tree.nwk')
row.names(alldata) = alldata$Species
tree_pruned = treedata(tree, alldata, sort=T, warnings=T)$phy
data<-as.data.frame(treedata(tree_pruned, alldata, sort=T, warnings=T)$data)
data$Species = as.character(data$Species)
data$TG_ACSkew = as.numeric(as.character(data$TG_ACSkew))
data$Temperature = as.numeric(as.character(data$Temperature))
data$GenerationLength_d = as.numeric(as.character(data$GenerationLength_d))
data$AllColdSpecies = as.numeric(as.character(data$AllColdSpecies))
data_comp <- comparative.data(tree_pruned, data[, c('Species', 'TG_ACSkew',
'GenerationLength_d', 'Temperature', 'AllColdSpecies')], Species, vcv=TRUE)
summary(pgls(TG_ACSkew ~ scale(Temperature) + scale(GenerationLength_d), data_comp, lambda="ML"))
summary(pgls(TG_ACSkew ~ AllColdSpecies + scale(GenerationLength_d), data_comp, lambda="ML"))
summary(pgls(TG_ACSkew ~ scale(GenerationLength_d), data_comp, lambda="ML"))
View(data)
knitr::opts_chunk$set(echo = TRUE)
rm(list=ls(all=TRUE))
if (!require(caper)) install.packages("caper")
if (!require(geiger)) install.packages("geiger")
if (!require(ggpubr)) install.packages("ggpubr")
if (!require(dplyr)) install.packages("dplyr")
if (!require(tidyr)) install.packages("tidyr")
library(tidyr)
library(caper)
library(geiger)
library(ggpubr)
library(dplyr)
sinnuccontent = read.table("../data/2derived/AllGenesCodonUsageNoOverlap.txt", header = TRUE, sep = '\t')
sinnuccontent = sinnuccontent[sinnuccontent$Gene != 'ND6',]
sinnuccontent = aggregate(list(sinnuccontent$NeutralA,sinnuccontent$NeutralT,sinnuccontent$NeutralG,sinnuccontent$NeutralC), by = list(sinnuccontent$Species), FUN = sum)
names(sinnuccontent) = c('Species','NeutralA','NeutralT','NeutralG','NeutralC')
sinnuccontent$FrT.heavy = sinnuccontent$NeutralA / (sinnuccontent$NeutralA + sinnuccontent$NeutralT + sinnuccontent$NeutralG + sinnuccontent$NeutralC)
sinnuccontent$FrA.heavy = sinnuccontent$NeutralT / (sinnuccontent$NeutralA + sinnuccontent$NeutralT + sinnuccontent$NeutralG + sinnuccontent$NeutralC)
sinnuccontent$FrC.heavy = sinnuccontent$NeutralG / (sinnuccontent$NeutralA + sinnuccontent$NeutralT + sinnuccontent$NeutralG + sinnuccontent$NeutralC)
sinnuccontent$FrG.heavy = sinnuccontent$NeutralC / (sinnuccontent$NeutralA + sinnuccontent$NeutralT + sinnuccontent$NeutralG + sinnuccontent$NeutralC)
KT = read.table("../data/2derived/EcologyMammalianTable01_KuptsovA_ver2_Full.txt", sep='\t', header=TRUE)
KT$FrT= NULL
alldata = merge(sinnuccontent, KT)
alldata$Temperature = as.numeric(gsub(",", ".", alldata$Temperature.C._White2003.2006.other.close.species))
alldata$GenerationLength_d = as.numeric(gsub(",", ".", alldata$GenerationLength_d))
alldata$AC.heavy = alldata$FrA.heavy+alldata$FrC.heavy
alldata$TG.heavy = alldata$FrT.heavy+alldata$FrG.heavy
alldata$TG_ACSkew = (alldata$TG.heavy-alldata$AC.heavy)/(alldata$AC.heavy+alldata$TG.heavy)
summary(lm(formula = FrA.heavy ~ scale(GenerationLength_d)+scale(Temperature), data = alldata))
summary(lm(TG_ACSkew ~ log2(Temperature)+log2(GenerationLength_d), data = alldata))
summary(lm(TG_ACSkew ~ scale(Temperature)+scale(GenerationLength_d), data = alldata))
alldata$MarsMono = alldata$Mars + alldata$Mono; table(alldata$MarsMono)
alldata$ColdSpecies = 0
alldata[alldata$Species %in% alldata[alldata$Temperature <= mean(alldata[!is.na(alldata$Temperature),]$Temperature) & !is.na(alldata$Temperature),]$Species,]$ColdSpecies = 1; table(alldata$ColdSpecies)
alldata$AllColdSpecies = alldata$Hib.unconfirmedHib + alldata$Daily.unconfirmedDaily + alldata$MarsMono + alldata$ColdSpecies
alldata[alldata$AllColdSpecies > 0,]$AllColdSpecies = 1; table(alldata$AllColdSpecies)
summary(lm(formula = TG_ACSkew ~ log2(GenerationLength_d)+AllColdSpecies, data = alldata))
summary(lm(formula = FrA.heavy ~ log2(GenerationLength_d)+AllColdSpecies, data = alldata))
